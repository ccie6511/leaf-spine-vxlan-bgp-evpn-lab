
hostname spine-4

feature bgp
feature ospf
feature nv overlay
feature vn-segment-vlan-based
feature feature pim
nv overlay evpn

router ospf underlay
  router-id 10.255.255.4

interface Ethernet1/1
  description P2P_UPLINK_TO_LEAF-1_Ethernet1/9
  no switchport
  ip address 10.255.254.6/31
  mtu 9192
  ip router ospf UNDERLAY area 0.0.0.0
  ip ospf network point-to-point
  ip pim sparse-mode
  no shutdown
interface Ethernet1/2
  description P2P_UPLINK_TO_LEAF-2_Ethernet1/9
  no switchport
  ip address 10.255.254.14/31
  mtu 9192
  ip router ospf UNDERLAY area 0.0.0.0
  ip ospf network point-to-point
  ip pim sparse-mode
  no shutdown
interface Ethernet1/3
  description P2P_UPLINK_TO_LEAF-3_Ethernet1/9
  no switchport
  ip address 10.255.254.22/31
  mtu 9192
  ip router ospf UNDERLAY area 0.0.0.0
  ip ospf network point-to-point
  ip pim sparse-mode
  no shutdown
interface Ethernet1/4
  description P2P_UPLINK_TO_LEAF-4_Ethernet1/9
  no switchport
  ip address 10.255.254.30/31
  mtu 9192
  ip router ospf UNDERLAY area 0.0.0.0
  ip ospf network point-to-point
  ip pim sparse-mode
  no shutdown
interface Ethernet1/5
  description P2P_UPLINK_TO_LEAF-5_Ethernet1/9
  no switchport
  ip address 10.255.254.38/31
  mtu 9192
  ip router ospf UNDERLAY area 0.0.0.0
  ip ospf network point-to-point
  ip pim sparse-mode
  no shutdown
interface Ethernet1/6
  description P2P_UPLINK_TO_LEAF-6_Ethernet1/9
  no switchport
  ip address 10.255.254.46/31
  mtu 9192
  ip router ospf UNDERLAY area 0.0.0.0
  ip ospf network point-to-point
  ip pim sparse-mode
  no shutdown
interface Ethernet1/7
  description P2P_UPLINK_TO_LEAF-7_Ethernet1/9
  no switchport
  ip address 10.255.254.54/31
  mtu 9192
  ip router ospf UNDERLAY area 0.0.0.0
  ip ospf network point-to-point
  ip pim sparse-mode
  no shutdown
interface Ethernet1/8
  description P2P_UPLINK_TO_LEAF-8_Ethernet1/9
  no switchport
  ip address 10.255.254.62/31
  mtu 9192
  ip router ospf UNDERLAY area 0.0.0.0
  ip ospf network point-to-point
  ip pim sparse-mode
  no shutdown
interface loopback0
  description router id
  ip address 10.255.255.4/32
  ip router ospf UNDERLAY area 0.0.0.0
interface loopback10
  description pim anycast
  ip address 10.255.253.10/32
  ip router ospf UNDERLAY area 0.0.0.0
  ip pim sparse-mode
interface loopback11
  description pim rp
  ip address 10.255.253.4/32
  ip router ospf UNDERLAY area 0.0.0.0
  ip pim sparse-mode

ip pim rp-address 10.255.253.10
ip pim anycast-rp 10.255.253.10 10.255.253.1
ip pim anycast-rp 10.255.253.10 10.255.253.2
ip pim anycast-rp 10.255.253.10 10.255.253.3
ip pim anycast-rp 10.255.253.10 10.255.253.4


router bgp 65500
  address-family ipv4 unicast
  router-id 10.255.255.4
  neighbor 10.255.255.11 remote-as 65500
    description spine-4-Loopback-to-leaf-1-Loopback
    update-source loopback0
    address-family l2vpn evpn
      send-community both
      route-reflector-client
  neighbor 10.255.255.12 remote-as 65500
    description spine-4-Loopback-to-leaf-2-Loopback
    update-source loopback0
    address-family l2vpn evpn
      send-community both
      route-reflector-client
  neighbor 10.255.255.13 remote-as 65500
    description spine-4-Loopback-to-leaf-3-Loopback
    update-source loopback0
    address-family l2vpn evpn
      send-community both
      route-reflector-client
  neighbor 10.255.255.14 remote-as 65500
    description spine-4-Loopback-to-leaf-4-Loopback
    update-source loopback0
    address-family l2vpn evpn
      send-community both
      route-reflector-client
  neighbor 10.255.255.15 remote-as 65500
    description spine-4-Loopback-to-leaf-5-Loopback
    update-source loopback0
    address-family l2vpn evpn
      send-community both
      route-reflector-client
  neighbor 10.255.255.16 remote-as 65500
    description spine-4-Loopback-to-leaf-6-Loopback
    update-source loopback0
    address-family l2vpn evpn
      send-community both
      route-reflector-client
  neighbor 10.255.255.17 remote-as 65500
    description spine-4-Loopback-to-leaf-7-Loopback
    update-source loopback0
    address-family l2vpn evpn
      send-community both
      route-reflector-client
  neighbor 10.255.255.18 remote-as 65500
    description spine-4-Loopback-to-leaf-8-Loopback
    update-source loopback0
    address-family l2vpn evpn
      send-community both
      route-reflector-client


